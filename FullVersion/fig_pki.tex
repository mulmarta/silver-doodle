\begin{figure}[!tbp]
	\vspace*{-1.5em}\begin{systembox}{$\funcPKI$}
		\begin{flushleft}
			\mbox{Parameter: key-package generation algorithm $\genPKIkeys$.}

			\hrulefill
			\vspace*{-0.5em}
		\end{flushleft}
			\begin{minipage}[t]{0.49\linewidth}
				{\bf Initialization}
				\begin{algorithmic}
					\State $\mathsf{SK}[\cdot, \cdot] \gets \bot$
				\end{algorithmic}


        {\bf Input $\keyword{GetSK}(PK)$ from $\id$}
				\begin{algorithmic}
          \State $SK \gets \mathsf{SK}[\id,PK]$
          \State $\mathsf{SK}[\id,PK] \gets \bot$
          \State \Return $SK$
				\end{algorithmic}
			\end{minipage}
			\hfill
			\begin{minipage}[t]{0.49\linewidth}
				{\bf Input $(\keyword{GetPK},\id')$ from $\id$}
				\begin{algorithmic}
          \State $(PK, SK) \gets \genPKIkeys()$
					\State $\mathsf{SK}[\id',PK] \gets SK$
					\State Send $(\id', PK)$ to adv.
					\State \Return $PK$
				\end{algorithmic}
			\end{minipage}
	\end{systembox}

	\caption{The Authenticated Key service Functionality.\vspace{0.5cm}}
	\label{fig:aks}
\end{figure}